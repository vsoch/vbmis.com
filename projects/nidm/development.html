

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Development &mdash; nidm 1.0 documentation</title>
  

  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="nidm 1.0 documentation" href="index.html"/>
        <link rel="prev" title="nidm.templates package" href="nidm.templates.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> nidm
          

          
            
            <img src="_static/nidm.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">nidm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Development</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-contribute-a-new-query">How do I contribute a new query?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#web-query-generator">Web Query Generator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#how-do-i-develop-the-api">How do I develop the API?</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-does-this-work">How does this work?</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#queries-vs-api">Queries vs. API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-logic">Application Logic</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#serving-an-api-and-web-interfaces">Serving an API and web interfaces</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/incf-nidash/nidm-api">Github repository</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/incf-nidash/nidm-query">nidm-query</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/vsoch/nidmviewer">nidm-viewer</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">nidm</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          





<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Development</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/development.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="development">
<h1>Development<a class="headerlink" href="#development" title="Permalink to this headline">¶</a></h1>
<div class="section" id="how-do-i-contribute-a-new-query">
<h2>How do I contribute a new query?<a class="headerlink" href="#how-do-i-contribute-a-new-query" title="Permalink to this headline">¶</a></h2>
<p>We have a dynamic web interface that will allow you to generate, preview (and eventually test) a new data structure for adding to <a class="reference external" href="https://github.com/incf-nidash/nidm-query">nidm-query</a>. This can also be done, using the same functions, programatically. You can then add it to the repo by submitting a pull request to add it. A pull request affords group discussion, and we will eventually have continuous integration that will run tests on your new query. We recommend that you use the generation functions to ensure accuracy in the format and fields of your data structure.</p>
<div class="section" id="web-query-generator">
<h3>Web Query Generator<a class="headerlink" href="#web-query-generator" title="Permalink to this headline">¶</a></h3>
<p>To generate a query with the interactive web interface, first start up the nidm application</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">nidm</span>
</pre></div>
</div>
<p>Then open your browser to localhost:8088/query/new. You will be presented with fields to fill in for your query:</p>
<img alt="_images/queryField.png" src="_images/queryField.png" />
<ul class="simple">
<li>title: This should be a single sentence that describes what your query does, what object model it is associated with, etc.</li>
<li>creator: We ask for your ORCID ID to be filled into the creator spot. If you don&#8217;t have this, you can put a name or email. We are currently not validating this, so you can really do whatever you like. We will (hopefully) decide on a standard.</li>
<li>description: This should be a text description of your query, please give details. The title and description will eventually be provided in a static web interface served with the repo for people to search and find queries they want to use.</li>
</ul>
<p>When you click next, the next page is where you should copy paste your sparql:</p>
<img alt="_images/querySparql.png" src="_images/querySparql.png" />
<p>If you are not ready to generate your file, you can click &#8220;Preview&#8221; for a new tab to open with the query. The parameters that the user is allowed to ask for will be extracted from your &#8220;select&#8221; line, indicated by a word preceded with ? (e.g., ?hello). Do not worry about capitalization.</p>
<img alt="_images/queryPreview.png" src="_images/queryPreview.png" />
<p>When you are ready to save your query, click &#8220;Create!&#8221;</p>
<img alt="_images/queryDownload1.png" src="_images/queryDownload1.png" />
<p>A file will be downloaded to your computer. You should drop this file into the appropriate directory in your <a class="reference external" href="https://github.com/incf-nidash/nidm-query">nidm-query</a>. repo and submit a PR to add it to the nidm-api. We will eventually have tests for the queries, and an interactive web interface hosted with the nidm-api to explore the queries available (before downloading the nidm-api).</p>
<img alt="_images/queryDownload2.png" src="_images/queryDownload2.png" />
<p>You can then download to your local machine:</p>
</div>
</div>
<div class="section" id="how-do-i-develop-the-api">
<h2>How do I develop the API?<a class="headerlink" href="#how-do-i-develop-the-api" title="Permalink to this headline">¶</a></h2>
<p>You will want to fork the repo, clone the fork, and then run the flask application directly (so that it updates with changes to your code):</p>
<div class="highlight-python"><div class="highlight"><pre>git clone https://github.com/[username]/nidm-api
cd nidm-api
python setup.py install --user
python nidm/app.py
</pre></div>
</div>
</div>
<div class="section" id="how-does-this-work">
<h2>How does this work?<a class="headerlink" href="#how-does-this-work" title="Permalink to this headline">¶</a></h2>
<p>Flask is a web framework (in python) that makes it ridiculously easy to do stuff with python in the browser. You can conceptually think of it like <a class="reference external" href="https://www.djangoproject.com/">Django</a> released wild and free from its mom&#8217;s minivan. If you look at app.py, you will see a bunch of functions that return different views, and each view is associated with a particular url (with variables) that the user might want.  You should first <a class="reference external" href="flask.pocoo.org/docs/0.10/quickstart/">familiarize yourself with flask</a> before trying to develop with it.</p>
<div class="section" id="queries-vs-api">
<h3>Queries vs. API<a class="headerlink" href="#queries-vs-api" title="Permalink to this headline">¶</a></h3>
<p>The queries are kept separate from the api itself, in the <a class="reference external" href="https://github.com/incf-nidash/nidm-query">nidm-query</a> repo. We did this because the world of writing sparql, and developing a web framework / API to serve the queries, are two separate things. A developer writing queries should be able to submit a PR to add a single file to the nidm-queries repo without needing to know about the nidm-api infrastructure. A developer working on the API shouldn&#8217;t need to worry about the sparql side of things.</p>
</div>
<div class="section" id="application-logic">
<h3>Application Logic<a class="headerlink" href="#application-logic" title="Permalink to this headline">¶</a></h3>
<p>The basic application logic is as follows:</p>
<ul class="simple">
<li>The user installs the application with pip. This installs the python modules to the user&#8217;s site-packages, but it also adds an executable, &#8220;nidm&#8221; to the users bin. This exectuable can be run to start the server instantly.</li>
<li>Upon the creation of the server, the nidm-queries repo is downloaded to a temporary directory. This ensures that queries are up to date at the start of the server. If you are using the functions from within your application, you can download the repo to a location of your choice and specify the location in your application.</li>
<li>The queries are json (ld) files. This just means they have a key called &#64;context with some kind of stuff that semantic web folk understand. We are showing them as standard .json files because the .jsonld extension is not widely known, and could be confusing.</li>
<li>The tool reads in all queries, and presents valid queries to the user at the base url of the server, localhost:8088. (Note that validation is not currently implemented). The user can select a query of choice based on the unique id, the &#8220;uid&#8221; variable in the json structure presented at localhost:8088.</li>
<li>The user can then look at the details for a query by way of locahost:8088/api/[qid], or perform a query on a ttl file with localhost:8088/api/query/[qid]?ttl=[ttl_file]. The [ttl_file] can be a local path, or a URL. This is the extent of the tool thus far, it is still under development.</li>
</ul>
</div>
</div>
<div class="section" id="serving-an-api-and-web-interfaces">
<h2>Serving an API and web interfaces<a class="headerlink" href="#serving-an-api-and-web-interfaces" title="Permalink to this headline">¶</a></h2>
<p>The url /api/[more-stuff-here] is linked up to serve a RESTful API, however the beauty of flask is that we can configure other URLs to do other interesting things. For example, /create might bring up an interactive web interface to write inputs to generate a new query object. /api/visual may be configured to return an interactive d3 or neo4j version of some part of the graph extracted from your ttl file. Having python and the infinite amount of web visualization technology at our fingertips makes the options really unlimited.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="nidm.templates.html" class="btn btn-neutral" title="nidm.templates package" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, NIDASH Working Group.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>